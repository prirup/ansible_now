---
- name: cisco_ios_facts_gather_with_filters
  hosts: cisco
  gather_facts: false
  connection: network_cli

  tasks:
    - name: gather_facts
      ios_facts:
        gather_subset:
          - config

      register: config_facts

    # By using the var.ansible_facts.dict_key format we can pull out the data we want from the variable
    # Use the comma to seperate the data if you want more than one value out of the dictionary
    - debug: var=config_facts.ansible_facts.ansible_net_hostname,config_facts.ansible_facts.ansible_net_model,config_facts.ansible_facts.ansible_net_serialnum,config_facts.ansible_facts.ansible_net_version

    - name: Create backup dir
      file:
        path: "/tmp/facts/{{ inventory_hostname }}"
        state: directory
        recurse: yes
      delegate_to: 127.0.0.1
      
    - name: save output to a file
      copy:
        # copy the value after the debug: var= to the content: "{{ <here> }}"
        content: "{{ config_facts.ansible_facts.ansible_net_hostname,config_facts.ansible_facts.ansible_net_model,config_facts.ansible_facts.ansible_net_serialnum,config_facts.ansible_facts.ansible_net_version }}"
        dest: "/tmp/facts/{{ inventory_hostname }}/{{ inventory_hostname }}_get_facts.txt"
      delegate_to: 127.0.0.1
